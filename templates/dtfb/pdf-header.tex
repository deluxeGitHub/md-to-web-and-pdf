% DTFB PDF header styling
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{fancyhdr}
\usepackage{geometry}
\usepackage{titlesec}
\usepackage{lastpage}
\usepackage{titling}
\usepackage{hyperref}
\usepackage{fontspec}

\definecolor{DTFBGreen}{HTML}{008F39}
\definecolor{DTFBDark}{HTML}{011C1D}
\definecolor{DTFBGray}{HTML}{4A4A49}

\IfFontExistsTF{TeX Gyre Heros}{\setmainfont{TeX Gyre Heros}}{\setmainfont{Latin Modern Sans}}
\IfFontExistsTF{TeX Gyre Heros Condensed}{\newfontfamily\dtfbtitlefont{TeX Gyre Heros Condensed}[Weight=500]}{\newfontfamily\dtfbtitlefont{TeX Gyre Heros}[Weight=500]}

\geometry{bottom=1.8in}

\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\setlength{\headheight}{40pt}
\setlength{\footskip}{34pt}
\fancyhead[L]{}
\fancyhead[R]{\includegraphics[height=50pt]{templates/dtfb/images/logo.png}}
\fancyfoot[L]{\hspace*{15pt}\raisebox{-10pt}{\textcolor{DTFBGray}{\small \thedate}}}
\fancyfoot[C]{\raisebox{0pt}{\IfFileExists{templates/dtfb/images/footer_decoration.png}{\includegraphics[width=\textwidth]{templates/dtfb/images/footer_decoration.png}}{}}}
\fancyfoot[R]{\raisebox{-10pt}{\textcolor{DTFBGray}{\small Seite \thepage\ von \pageref{LastPage}}}}

\titleformat{\section}{\Large\bfseries\color{DTFBGreen}}{\thesection}{0.6em}{}
\titleformat{\subsection}{\large\bfseries\color{DTFBGreen}}{\thesubsection}{0.6em}{}
\titleformat{\subsubsection}{\normalsize\bfseries\color{DTFBGreen}}{\thesubsubsection}{0.6em}{}

\setlength{\parskip}{0.6em}
\setlength{\parindent}{0pt}

\hypersetup{
  colorlinks=true,
  linkcolor=DTFBGreen,
  urlcolor=DTFBGreen
}

\makeatletter
\newcommand{\dtfbsubtitle}{}
\@ifundefined{subtitle}{
  \newcommand{\subtitle}[1]{\gdef\dtfbsubtitle{#1}}
}{
  \let\dtfborigsubtitle\subtitle
  \renewcommand{\subtitle}[1]{\gdef\dtfbsubtitle{#1}\dtfborigsubtitle{#1}}
}
\makeatother

\makeatletter
\renewcommand{\maketitle}{
  \fancyhead[R]{}
  \begin{titlepage}
    \thispagestyle{fancy}
    \vspace*{1.2cm}
    \begin{center}
      \includegraphics[height=80pt]{templates/dtfb/images/logo.png}\par
      \vspace{0.9cm}
      {\Huge\dtfbtitlefont\bfseries\color{DTFBGreen}\thetitle\par}
      \ifx\dtfbsubtitle\@empty\else
        \vspace{0.35cm}
        {\Large\color{DTFBGray}\dtfbsubtitle\par}
      \fi
      \vspace{0.8cm}
      {\large\color{DTFBGray}Stand: \thedate\par}
    \end{center}
    \vfill
  \end{titlepage}
  \setcounter{page}{2}
  \fancyhead[R]{\includegraphics[height=50pt]{templates/dtfb/images/logo.png}}
}
\makeatother
